# Issue 0005: 層化サンプリング結果の評価と運用フロー整備

## 背景
層化サンプリング処理を導入した後、その効果を定量的に検証し、継続運用できる体制を整える必要があります。生成されたデータセットの分布が目標に沿っているかを確認するとともに、モデル性能や再実行手順を確立することで実運用に耐えられる仕組みになります。

## タスク詳細
1. **分布評価レポートの整備**
   - Issue 0004のサンプリング結果を読み込み、シナリオ軸ごとの実績分布と目標分布の乖離指標（KLダイバージェンス、最大乖離率など）を算出する。
   - 追加でPopulation Stability Index（PSI）やEarth Mover's Distanceを算出し、Rabanser et al. (2019, *Failing Loudly*)の手法を参考にシフト検出感度を比較する。必要に応じてKolmogorov-Smirnov検定とカイ二乗検定を併用し、統計的妥当性を確認する。
   - サンプリング前後の比較グラフ、希少ビンの充足状況、想定外の偏りをまとめたレポートを作成する。
   - 類似ケーススタディとしてBuda et al. (2018, *Class Imbalance in Deep Learning for Computer Vision Tasks*)やZhu et al. (2022, *NuScenes-Night: A Multi-Modal Dataset for Night-time Autonomous Driving*)などを調査し、評価指標の採用理由と限界を引用付きで整理する。
2. **モデル性能評価の設計と実施**
   - モデル学習に用いる前処理・学習スクリプトを整理し、層化サンプリング有無で再現可能な実験設定（ハイパーパラメータ、乱数シード、評価指標）を定義する。
   - 希少シナリオ（例: 雨天夜間、交差点右折）に焦点を当てた評価指標を追加し、統計的有意差検定を行う。
   - 評価結果をテンプレート化したサマリーレポート（学習ログ、混同行列、シナリオ別指標）にまとめる。
3. **運用プロセスと再実行フロー設計**
   - 新規データ投入時のパイプライン再実行手順（トリガー条件、計算リソース、想定所要時間）を定義する。
   - 品質チェックリスト（データ欠損率、メタデータ更新率、クリップ数の変化）を作成し、チェック自動化スクリプトを設計する。
   - 実行結果や異常を監視するモニタリング指標（ジョブ成功率、データ鮮度）を明文化する。
4. **自動化とオペレーション設計**
   - Kubeflow Pipelinesを標準オーケストレーターと想定し、CI/CDや定期バッチと連携したジョブ設定、権限、通知設計を行う。
   - 想定障害ケース（データ取得失敗、計算ノード障害）とリカバリ手順をRunbookに記載する。
5. **ドキュメント統合とレビュー**
   - 評価レポート、運用フロー、Runbookを統合し、関係者レビューを経て正式な運用ガイドラインとして承認を得る。
   - 運用開始後の改善サイクル（レビュー頻度、指標更新手順）を定め、ロードマップに反映する。

## 成果物
- 分布評価レポートと可視化成果物
- 層化サンプリング有無のモデル性能比較レポート
- パイプライン再実行フロー、品質チェックリスト、Runbook
- 運用ガイドラインおよびモニタリング指標一覧

## 追加で確認すべき情報
- モデル学習・評価に利用する最新スクリプト/パイプラインの場所とメンテナンス責任者
- 運用環境（オンプレ/クラウド）におけるジョブスケジューラ・監視ツールの選定状況
- ビジネス側のKPIやリリーススケジュールと評価レポート提出タイミング
